/** PanoPress v.1.1 | Developed by Omer Calev <http://www.omercalev.com/> | Code licensing & documentation <http://www.panopress.org/> **/
var panopress=function(){function fa(){for(var a=0,b=G.length;a<b;a++)try{G[a]()}catch(c){}G=[]}function J(){Q||(Q=!0,fa())}function K(a){var b=a.indexOf("-");if(0===b)return a=a.substring(1),a.substring(0,1).toUpperCase(),a.substring(1),K(name);0<b&&(a=a.substring(0,b)+a.substring(b+1,b+2).toUpperCase()+a.substring(b+2));return 0<a.indexOf("-")?K(a):a}function ga(a){a=a.replace(/^\s+|\s+$/g,"").toLowerCase();if(-1!=a.indexOf("rgb")){rgba=a.substring(a.indexOf("(")+1,a.indexOf(")")).split(",");a= "#";for(var b=0;3>b;b++)a+=parseInt(rgba[b]).toString(16)}return a}function pa(a,b,c){a=document.createElement(a);return b?c?b.insertBefore(a,b.firstChild):b.appendChild(a):a}function L(a,b){return a.parentNode.replaceChild(b,a)?b:!1}function R(a){if(H&&"object"==a.nodeName)for(var b=0;b<a.length;b++)"function"==typeof a[b]&&(a[b]=null);return a.parentNode.removeChild(a)}function S(a,b,c){a.style[K(b)]=c;"opacity"==b&&(a.style.filter="alpha( opacity="+100*c+" )");return a}function E(a,b){for(var c in b)S(a, c,b[c]);return a}function u(a,b,c){var d="";if(window.getComputedStyle)d=document.defaultView.getComputedStyle(a,null).getPropertyValue(b);else if(a.currentStyle){var k=K(b),d=a.currentStyle[K(b)];"auto"==d&&(d="width"==k?a.offsetWidth:a.offsetHeight)}c&&("string"==typeof d&&(k=d.indexOf("px"),-1!=k&&(d=d.substring(0,k))),d="opacity"==b?parseFloat(d):parseInt(d));return d}function ha(a,b,c){function d(a){return""==a||"transparent"==a||"rgba(0, 0, 0, 0)"==a}a=a.parentNode;for(var k=u(a,b,c);a&&1== a.nodeType&&d(k);)a=a.parentNode,1==a.nodeType&&(k=u(a,b,c));return k==d(k)?!1:k}function ia(a,b){for(var c=a.split(" "),d=0;d<c.length;d++)""!=c[d]&&b(c[d].replace(/^\s+|\s+$/g,""))}function C(a,b){ia(b,function(b){var d=!0;ia(b,function(b){RegExp("(^|\\s)"+b+"(\\s|$)","i").test(a.className)||(d=!1)});d||(cn=a.className,a.className=cn+(cn.length?" ":"")+b)});return a}function ja(a,b){ia(b,function(b){a.className=a.className.replace(RegExp("(^|\\s)"+b+"(\\s|$)","i"),function(a){var b="";/^\s+.*\s+$/.test(a)&& (b=a.replace(/(\s+).+/,"$1"));return b}).replace(/^\s+|\s+$/g,"")});return a}function Y(a,b,c,d){var k="undefined"!=typeof d;document.addEventListener?a.addEventListener(b,k?function(a){c(a,d)}:c,!1):document.attachEvent&&a.attachEvent("on"+b,k?function(a){c(a,d)}:c);return a}function Z(a,b,c){document.removeEventListener?a.removeEventListener(b,c,!1):document.detachEvent&&a.detachEvent("on"+b,c);return a}function w(a,b,c){var d=document.createElement("div");d.innerHTML=a;return b?c?b.insertBefore(d.firstChild, b.firstChild):b.appendChild(d.firstChild):d.firstChild}function W(a,b){b=b||document;return b.getElementsByTagName(a)}function $(a,b,c,d,k,j){return new ya(a,b,u(a,b),c,d,k,j)}function ya(a,b,c,d,k,j,V){var m=0,e=aa.seq(c,d,k,j),g=this;this.active=!0;this.animate=function(){this.paused||(m==e.length-1&&(this.active=!1,V&&V()),S(a,b,e[m]),m++)};this.paused=!1;this.reset=function(){m=0;g.active=!0}}function qa(a){var b=[],c=this;this.active=!0;this.animate=function(){if(!this.paused){for(var d=0,c= 0;c<b.length;c++)b[c].active&&(b[c].animate(),d++);0==d&&(a&&a(),this.active=!1)}};this.add=function(a){b.push(a)};this.paused=!1;this.reset=function(){for(var a=0;a<b.length;a++)b[a].reset();c.active=!0}}function ra(a,b,c,d,k){switch(c){case "fast":c=200;break;case "slow":c=600;break;default:c=c||400}k=new qa(k);for(var j in b)k.add(new $(a,j,b[j],c,d||EASE_IN_OUT));aa.add(k)();return k}function I(a,b,c,d,k){return ra(a,{opacity:b},c,d||EASE_NONE,k)}function T(a){var b=!1,c;if(H){var d=null;try{d= new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(k){}if(d){var j=null;try{j=d.GetVariable("$version")}catch(V){}j&&(j=j.split(" ")[1].split(","),c=[parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10)],b=!0)}}else if(d=navigator.mimeTypes["application/x-shockwave-flash"])if(b="object"==typeof d.enabledPlugin&&"object"==typeof navigator.plugins["Shockwave Flash"])c=[],j=d.enabledPlugin.description,j=j.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),c[0]=parseInt(j.replace(/^(.*)\..*$/,"$1"),10),c[1]=parseInt(j.replace(/^.*\.(.*)\s.*$/, "$1"),10),c[2]=/[a-zA-Z]/.test(j)?parseInt(j.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;return!b?!1:a?(a=a.split("."),c[0]>a[0]?!0:c[0]==a[0]?c[1]>a[1]?!0:c[1]==a[1]?c[2]>a[2]?!0:!1:!1:!1):!0}function sa(a){return'<div class="pp-error">'+(a+'<br><a href="http://www.adobe.com/go/getflashplayer" target="_blank"><img src="'+M+'images/get-flash.gif"></a>')+"</div>"}function I(a,b,c,d){ra(a,{opacity:b},c,EASE_NONE,d)}function N(a,b){v=new ta(pb_options,b);var c=[],d;for(d in y)y[d].panobox&&(d==a&&(a=c.length), c.push(d),v.add(function(a){v.show(C(y[c[a]].getContent(v.bgcolor),"pb-content"),null,null,!1,y[c[a]].title)}));v.show(w("<div />"),null,null,!0,y[a].title,function(){v.play(a)})}function za(a,b,c,d,k,j,V,m,e,g,l,h,B){function v(a,b){var c=w('<div style="width:100%;height:100%;top:0px;left:0px;cursor:pointer;position:absolute;margin:0;padding:0;border:0;" />',a);h&&C(c,"pp-embed-play");c.onclick=function(a){a=a||window.event;pp_oppp&&(O!=s&&-1!=O)&&y[O].reset();O=s;b(a);"undefined"!=typeof _trackEvent&& _trackEvent("PanoPress","Play",e)};return c}function q(){function a(b){if("window"!=t.wmode){b=b||window.event;var c=b.target,d=0;b.wheelDelta?(d=b.wheelDelta/120,window.opera&&(d=-d)):b.detail&&(d=-b.detail/3);d&&(c.get?(!0!=c.jsmwfix_on&&c.enable_mousewheel_js_bugfix&&(c.enable_mousewheel_js_bugfix(),c.jsmwfix_on=!0),c.externalMouseEvent?(c.externalMouseEvent(d),c.focus()):(d=c.get("view.fov")+5*d,c.call("zoomto("+d+")"))):c.changeFov&&(d=c.getFov()-5*d,c.moveTo(c.getPan(),c.getTilt(),d,1)))}b.preventDefault&& b.preventDefault();b.returnValue=!1}var b=null,c=b="",f;for(f in t)b+='<param name="'+f+'" value="'+t[f]+'" />';if(H){for(var e in n)"data"==e.toLowerCase()?b+='<param name="movie" value="'+n[e]+'" />':"styleclass"==e.toLowerCase()?c+=' class="'+n[e]+'"':"classid"!=e.toLowerCase()&&(c+=" "+e+'="'+n[e]+'"');f="tmp_"+d;e=pa("object",W("body")[0]);e.id=f;e.outerHTML='<object id="'+f+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" '+c+">"+b+"</object>";b=document.getElementById(f)}else{for(e in n)c+= " "+e+'="'+n[e]+'"';b=w("<object type=application/x-shockwave-flash"+c+">"+b+"</object>")}window.addEventListener?Y(b,"DOMMouseScroll",a):b.onmousewheel=b.onmousewheel=a;return b}function r(){fsrc=k+"?";for(var a in m)fsrc+=a+"="+m[a]+"&";return w('<iframe src="'+fsrc+'" marginheight="0" marginwidth="0" frameborder="0" scrolling="no" style="display:none;width:'+j+";height:"+V+'" />')}function G(a,b){return w('<a href="'+a+'" />'+(b||'<img src="'+M+'images/play.png" width="80" height="80" />')+"</a>")} function ua(){if(!l&&B){var a=G("javascript:void(0)",e?e:g?g:null);a.onclick=function(a){N(s,a)};f=L(f,a)}else if(!l&&!pp_oppp||pp_oppp&&0==s&&ba&&!B)ba=!1,pp_oppp&&0==s&&(O=0),f=L(f,r()),S(f,"display","block"),C(f,"pp-embed-content");else var b=new v(f.parentNode,function(a){B?N(s,a):(f=L(f,r()),S(f,"display","block"),C(f,"pp-embed-content"),R(b))})}var t=null,n=null,s=0,f=null,ba=!0;this.title=e;this.panobox=B;this.init=function(h){function w(){l&&S(f.parentNode,"background-image","url("+l+")")} s=h;var F=f=document.getElementById(d);if(F.hasChildNodes())for(;0<F.childNodes.length;)R(F.firstChild);switch(b){case "flash":w();h=m.flashvars;F="krpano"==a?"":"externalinterface=1&";if(T){var z;T&&x&&c?(z=c.split("."),z=x[0]>z[0]?!0:x[0]==z[0]?x[1]>z[1]?!0:x[1]==z[1]?x[2]>z[2]?!0:!1:!1:!1):z=!1;if(z){for(var r in h)F+=r+"="+h[r]+"&";t={flashvars:F,allowfullscreen:"true",quality:"high",menu:"false",bgcolor:ga(ha(f,"background-color"))};for(var D in m)"flashvars"!=D&&(t[D]=m[D]);n={data:k};if(!l&& B)f=L(f,G("javascript:void(0)",e?e:g?g:null)),f.onclick=function(a){a=a||window.event;N(s,a)};else{if("auto"==t.wmode){r="window";if("fpp"!=a&&l&&(!B||!pb_options.fullscreen)&&999>u(f,"width",!0)&999>u(f,"height",!0))r="opaque";if("window"==r)for(D=0;D<y.length;D++)if(y[D].panobox){r="opaque";break}t.wmode=r}if(!l&&!pp_oppp||pp_oppp&&0==s&&ba&&!B)ba=!1,pp_oppp&&0==s&&(O=0),f=L(f,q()),E(f,{width:j,height:V}),C(f,"pp-embed-content");else var H=new v(f.parentNode,function(a){B?N(s,a):(f=L(f,q()),E(f, {opacity:"0",display:"block",width:j,height:V}),C(f,"pp-embed-content"),I(f,1,600),R(H))})}}else f.innerHTML=sa("Adobe Flash Player "+c+" or higher needed")}else f.innerHTML=ka?'<div class="pp-error">This device does not support Adobe Flash.</div>':sa("Adobe Flash Player needed");break;case "html":w();ua(h);break;case "link":w(),ua(h)}};this.reset=function(){f=L(f,w('<div id="'+d+'" />'));this.init(s)};this.getContent=function(a){if("flash"==b){var c=w("<div/>",W("body")[0]);a&&(t.bgcolor=a);return q(c)}return"html"== b?r():null}}function ta(a,b){function c(a){var b=z.childNodes;ja(b[r],"pb-nav-dot-active");C(b[r],"pb-nav-dot-on");r=a;q[r](r);ja(b[r],"pb-nav-dot-on");C(b[r],"pb-nav-dot-active")}function d(){J||(J=!0,a.fade?I(n,0,100,function(){R(n)&&I(t,0,50,function(){R(t)&&(Z(window,"keydown",Q),Z(window,"resize",N),Z(window,"orientationchange",N),J=!1)})}):R(n)&&R(t)&&(Z(window,"keydown",Q),J=!1))}function k(b,c){a.fade?(E(b,{display:"block",opacity:0}),L(f.firstChild,b),I(f.firstChild,1,500,c)):(S(b,"display", "block"),L(f.firstChild,b),c&&c())}function j(b,c,d,e,g,j,l){var m=(ka?window.innerWidth:document.documentElement.clientWidth)-K.width,q=(ka?window.innerHeight:document.documentElement.clientHeight)-K.height-28,v=null,r=function(a,b){if(!/[^0-9]/.test(a))return a;var c=a.length-1,d=a.charAt(c),e="h"==b.toLowerCase(),f=function(){if(!v){if(!la){var a=w('<div style=" width: 1in; height: 1in; position: absolute; left: -100%; top: -100%;"></div>',W("body")[0]);la={x:a.offsetWidth,y:a.offsetHeight};R(a)}v= la}return v[e?"y":"x"]};"%"!=d&&(d=a.substring(--c));c=parseInt(a.substring(0,c));switch(d){case "%":c*=(e?q:m)/100;break;case "em":c*=u(B,"font-size",!0);break;case "ex":c=c*u(B,"font-size",!0)/2;break;case "in":c*=f();break;case "cm":c=c*f()/2.54;break;case "mm":c=c*f()/25.4;break;case "pt":c=c*f()/72;break;case "pc":c=c*f()/6}return Math.round(c)};a.fullscreen?(c=m,d=q):(c=r(c||a.width,"w"),d=r(d||a.height,"h"));if(c>m||d>q)e?(e=Math.max(c/m,d/q),c=Math.round(c/e),d=Math.round(d/e)):(c>m&&(c=Math.round(c/ (c/m))),d>q&&(d=Math.round(d/(d/q))));e={width:c+"px",height:d+28+"px",top:(q-d)/2+"px",left:(m-c)/2+"px"};var s={width:c+"px",height:d+"px"};if(g){x||E(n,{width:"10px",height:"10px",top:h.clientY+"px",left:h.clientX+"px",display:"block"});g=u(n,"width",!0);r=u(n,"height",!0);x&&(g!=c||r!=d)&&ja(n,"pb-shadow");duration=Math.round(Math.max(Math.min(c-g,d-r),Math.min(c+g,d+r))/(j/1E3));c=new qa(function(){a.shadow&&C(n,"pb-shadow");b&&(E(b,s),k(b,l))});for(var t in e)c.add(new $(n,t,e[t],duration,F)); if(f.firstChild)for(t in s)c.add(new $(f,t,s[t],duration,F)),c.add(new $(f.firstChild,t,s[t],duration,F));aa.add(c)()}else e.display="block",E(n,e),E(f,s),a.shadow&&C(n,"pb-shadow"),b&&k(b,l),f.firstChild&&E(f.firstChild,s)}if(b.target)h=b;else{var h={};h.clientX=b.clientX;h.clientY=b.clientY;h.target=b.srcElement}for(var m=0,e=W("*"),g=0;g<e.length;g++){var l=u(e[g],"z-index",!0);l>m&&"auto"!=l&&(m=l)}var F=EASE_OUT,B=W("body")[0],q=[],v={},r=0,y=0,x=!1,e="-"+Math.floor(11111*Math.random()),t=w('<div id="overlay'+ e+'" style="width:100%;height:100%;position:fixed;z-index:'+(m+1)+';left:0px;top:0px;display:none" class="pb-overlay '+a.style.overlay+'"></div>',B),n=w('<div id="box'+e+'" style="display:none;position:fixed;z-index:'+(m+2)+'" class="pb-box '+a.style.box+'"></div>',B),g='<div id="container'+e+'"><div id="alt'+e+'"></div></div>'+('<div id="close'+e+'" class="pb-close"></div>'),g=g+('<div id="title'+e+'" class="pb-title"></div>'),g=g+('<div id="nav'+e+'" class="pb-nav"><div id="dots'+e+'" class="pb-nav-dots"></div></div>'), g=g+('<div id="loader'+e+'" class="pb-loader"></div>');n.innerHTML=g;var s=document.getElementById("loader"+e),f=document.getElementById("container"+e),G=document.getElementById("alt"+e),H=document.getElementById("nav"+e),M=document.getElementById("close"+e),O=document.getElementById("title"+e),z=document.getElementById("dots"+e),K,g=n,l=["padding","margin","border"],D=["right","left"],T=["top","bottom"],X={width:0,height:0},U;for(U in l){for(var P in D)X.width+=u(g,l[U]+"-"+D[P]+("border"==l[U]? "-width":""),!0);for(var A in T)X.height+=u(g,l[U]+"-"+T[A]+("border"==l[U]?"-width":""),!0)}K=X;if("pb-adaptive"==a.style.box){U=ha(h.target,"background-color");A=ga(U);A="#"==A[0]?A.substring(1):A;P=[];for(l=g=0;3>l;l++)D=3==A.length?A[l]+A[l]:A.substring(g,g+2),P.push(parseInt(D,16)),g+=2;A=60;g="dark";384<P[0]+P[1]+P[2]&&(A*=-1,g="light");C(t,"pb-"+g+"-overlay");C(n,"pb-"+g);l="rgb(";for(g=0;g<P.length;g++)l+=P[g]+A,g<P.length-1&&(l+=",");E(n,{"background-color":U,"border-color":l+")",color:ha(h.target, "color")})}var J=!1;this.id=e;this.bgcolor=ga(u(n,"background-color"));this.play=function(a){c(a)};this.add=function(a){q.push(a);a=w('<div class="pb-nav-dot pb-nav-dot-on" />',z);var b="dot_"+y;v[b]=y++;S(z,"width",u(z,"width",!0)+20+"px");a.onclick=function(){c(v[b])}};this.layer=function(a){m++;return w('<div style="width:'+f.style.width+";height:"+f.style.height+";top:"+u(n,"padding-top")+";left:"+u(n,"padding-left")+";position:absolute;zIndex:"+(m+1)+'" class="'+a+'" />',n)};this.showLoader= function(){var a=u(n,"padding-top",!0)+u(f,"height",!0)/2-u(s,"height",!0)/2+"px",b=u(n,"padding-left",!0)+u(f,"width",!0)/2-u(s,"width",!0)/2+"px";E(s,{top:a,left:b,"z-index":m+1,opacity:0,display:"block"});setTimeout(function(){I(s,1,150)},200)};this.hideLoader=function(){S(s,"display","none")};this.reset=function(){this.hideLoader();k(G)};this.show=function(b,c,d,e,f,g){O.innerHTML=f||"";f=u(t,"opacity");x?j(b,c,d,e,a.animate,2500,g):(E(t,{opacity:0,display:"block"}),I(t,f,200,function(){j(b,c, d,e,a.animate,2500,function(){var b=a.fade?180:0;I(O,1,b);I(M,1,b);1<q.length&&I(H,1,b);Y(window,"keydown",Q);Y(window,"resize",N,e);Y(window,"orientationchange",N,e);x=!0;g&&g()})}))};t.onclick=d;M.onclick=d;var Q=function(a){27==a.keyCode&&d()},N=function(a,b){j(null,null,null,b,!1,0)}}for(var M,q=W("script"),h=0,ma="";h<q.length&&""==ma;){var va=q[h].src.lastIndexOf("panopress.js");-1!=va&&(ma=q[h].src.substring(0,va));h++}M=ma;M=M.substring(0,M.lastIndexOf("js"));var H=/msie/i.test(navigator.userAgent), ka=/iPhone|iPad|iPod/i.test(navigator.userAgent),Q=!1,wa=null,G=[],aa=null;document.addEventListener&&document.addEventListener("DOMContentLoaded",J,!1);H&&document.getElementById&&(q="r"+Math.random(),document.write('<script id="'+q+'" defer src="//:">\x3c/script>'),document.getElementById(q).onreadystatechange=function(){"complete"===this.readyState&&J.call(this)});/KHTML|WebKit|iCab/i.test(navigator.userAgent)&&(wa=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(J.call(this), clearInterval(wa))},10));window.onload=J;EASE_NONE=[100];EASE_IN=[1,2,4,6,8,9,10,10,10,10,10,10,10];EASE_OUT=[10,10,10,10,10,10,10,9,8,6,4,2,1];EASE_IN_OUT=[1,2,3,4,5,6,7,8,9,10,9,8,7,6,5,4,3,2,1];var ca=[],na=!1,da=null,ea=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null,xa=0,oa=function(){for(var a=0,b=0;b<ca.length;b++)ca[b].active&&(ca[b].animate(),a++);xa++;(new Date).getTime(); 0==a?(clearInterval(da),da=null,na=!1,list=[],xa=0):ea&&ea(oa)},aa={start:function(){if(da||na)return!1;na=!0;(new Date).getTime();ea?ea(oa):da=setInterval(oa,17)},add:function(a){a.active||a.reset();ca.push(a);return this.start},seq:function(a,b,c,d){function k(a){if("string"==typeof a){var b=a.indexOf("px");-1!=b&&(a=a.substring(0,b),j="px");return parseFloat(a)}return a}var j="",h=[a];a=k(a);b=k(b);var m=a;a=(b-a)/100;c=Math.ceil(c/17/d.length);for(var e=0;e<d.length;e++)for(var g=a*d[e]/c,l=0;l< c;l++)h.push((m+=g)+j);h[h.length]=b+j;return h}},y=[],v=null,O=-1,T=!1,x=null,la=null;if(H){q=null;try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(Aa){}if(q){h=null;try{h=q.GetVariable("$version")}catch(Ba){}h&&(h=h.split(" ")[1].split(","),x=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)],T=!0)}}else if(q=navigator.mimeTypes["application/x-shockwave-flash"])if(T="object"==typeof q.enabledPlugin&&"object"==typeof navigator.plugins["Shockwave Flash"])x=[],h=q.enabledPlugin.description, h=h.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),x[0]=parseInt(h.replace(/^(.*)\..*$/,"$1"),10),x[1]=parseInt(h.replace(/^.*\.(.*)\s.*$/,"$1"),10),x[2]=/[a-zA-Z]/.test(h)?parseInt(h.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;G.push(function(){for(var a=0;a<y.length;a++)y[a].init(a)});Q&&fa();return{embed:function(a){y.push(new za(a.viewer,a.type,a.version,a.id,a.file,a.width,a.height,a.params,a.title,a.alt,a.preview,a.button,a.panobox))},imagebox:function(){var a=null;G.push(function(){var b;b=document;if(document.getElementsByClassName)a= b.getElementsByClassName("panobox");else{var c=[];b=b.getElementsByTagName("*");for(var d=0;d<b.length;d++)if(b[d]&&1==b[d].nodeType){var h=b[d].className;if(0<h.length)for(var h=h.split(" "),j=0;j<h.length;j++)"panobox"==h[j]&&c.push(b[d])}a=c}for(c=0;c<a.length;c++)a[c].onclick=function(b){b=b||window.event;var c={},d;for(d in pb_options)c[d]=pb_options[d];c.resize=0;c.fullscreen=0;v=new ta(c,b);var g=0;for(d=0;d<a.length;d++)this.href==a[d].href&&(g=d),v.add(function(b){var c=a[b].href,d=a[b].title; b=H?c+"?r="+Math.random():c;var e=pa("img");v.showLoader();e.onload=function(){v.reset();v.show(e,e.width,e.height,!0,d)};e.src=b});d=2*(12+8*a.length+6*this.title.length+32);v.show(w("<div/>"),Math.max(d,300),300,!0,this.title,function(){v.play(g)});return!1}});Q&&fa()}}}();
